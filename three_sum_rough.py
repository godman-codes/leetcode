class Solution:
    def threeSumClosest(self, nums, target: int) -> int:
        nums.sort()
        return self.KSumClosest(nums, 3, target)

    def KSumClosest(self, nums, k: int, target: int) -> int:
        N = len(nums)
        if N == k:
            return sum(nums[:k])

        # target too small
        current = sum(nums[:k])
        if current >= target:
            return current

        # target too big
        current = sum(nums[-k:])
        if current <= target:
            return current
        
        if k == 1:
            return min([(x, abs(target - x)) for x in nums], key = lambda x: x[1])[0]

        closest = sum(nums[:k])
        for i, x in enumerate(nums[:-k+1]):
            if i>0 and x == nums[i-1]:
                continue
            current = self.KSumClosest(nums[i+1:], k-1, target - x) + x
            if abs(target - current) < abs(target - closest):
                if current == target:
                    return target
                else:
                    closest = current

        return closest
print(Solution().threeSumClosest([-999, -993, -989, -987, -986, -983, -982, -981, -979, -978, -977, -974, -973,
                                  -966, -964, -961, -960, -956, -955, -954, -952, -950, -949, -947, -946, -945, -943, -937, 
                                  -936, -934, -928, -924, -923, -920, -919, -918, -917, -915, -914, -913, -911, -910, -909, 
                                  -908, -907, -906, -903, -902, -897, -896, -894, -892, -891, -888, -886, -885, -884, -881, 
                                  -880, -879, -877, -874, -873, -870, -867, -865, -860, -857, -855, -852, -851, -850, -849, 
                                  -846, -841, -839, -838, -837, -835, -834, -833, -832, -829, -827, -824, -820, -818, -816, 
                                  -815, -814, -811, -808, -807, -806, -804, -803, -801, -798, -796, -795, -792, -785, -782, 
                                  -781, -776, -775, -774, -770, -769, -768, -765, -762, -758, -756, -753, -752, -751, -743, 
                                  -739, -738, -737, -736, -733, -731, -730, -727, -725, -723, -721, -718, -717, -715, -709, 
                                  -708, -707, -701, -696, -695, -694, -692, -690, -688, -685, -683, -681, -678, -677, -675, 
                                  -674, -671, -668, -666, -664, -663, -662, -661, -659, -658, -657, -656, -654, -653, -652, 
                                  -650, -648, -646, -645, -644, -643, -639, -638, -637, -635, -633, -631, -630, -629, -626, 
                                  -619, -618, -616, -613, -611, -609, -608, -605, -603, -602, -600, -599, -598, -596, -595, 
                                  -594, -593, -591, -590, -587, -585, -584, -583, -582, -581, -578, -576, -574, -573, -572, 
                                  -570, -569, -567, -566, -565, -563, -562, -560, -557, -555, -552, -550, -549, -548, -545, 
                                  -540, -539, -536, -535, -532, -531, -528, -526, -524, -522, -520, -519, -517, -516, -515, 
                                  -512, -511, -509, -503, -500, -499, -498, -496, -495, -494, -493, -491, -487, -485, -484, 
                                  -483, -482, -480, -478, -476, -475, -474, -470, -469, -467, -466, -465, -460, -459, -457, 
                                  -456, -455, -454, -452, -451, -450, -447, -446, -442, -439, -438, -432, -431, -426, -420, 
                                  -419, -417, -416, -415, -414, -413, -412, -411, -409, -408, -407, -406, -404, -402, -400, 
                                  -396, -393, -391, -390, -389, -388, -386, -385, -384, -383, -382, -381, -380, -379, -378, 
                                  -377, -375, -374, -373, -371, -369, -368, -366, -364, -363, -362, -361, -360, -359, -356, 
                                  -354, -352, -351, -350, -348, -343, -342, -341, -340, -339, -333, -329, -328, -323, -322, 
                                  -320, -319, -317, -316, -313, -312, -311, -310, -309, -308, -307, -305, -304, -303, -302, 
                                  -301, -300, -298, -296, -293, -291, -289, -287, -282, -281, -278, -277, -276, -275, -274, 
                                  -273, -272, -270, -269, -264, -263, -261, -258, -254, -252, -250, -248, -246, -244, -243, 
                                  -242, -237, -236, -234, -233, -232, -229, -226, -225, -224, -223, -222, -220, -219, -212, 
                                  -206, -204, -203, -201, -200, -198, -197, -196, -195, -194, -193, -191, -190, -189, -188, 
                                  -187, -186, -182, -181, -180, -179, -178, -177, -167, -165, -163, -162, -161, -160, -158, 
                                  -154, -151, -149, -145, -144, -142, -141, -139, -138, -135, -134, -133, -132, -127, -126, 
                                  -125, -123, -120, -119, -116, -111, -109, -108, -106, -105, -104, -101, -100, -97, -96, -94,
                                  -89, -88, -84, -83, -82, -81, -80, -79, -77, -75, -74, -73, -71, -70, -67, -66, -64, -63,
                                  -59, -58, -54, -53, -52, -51, -50, -47, -43, -41, -37, -36, -35, -34, -33, -32, -28, -25,
                                  -24, -22, -20, -18, -15, -13, -11, -10, -5, -4, -1, 0, 3, 4, 6, 7, 10, 13, 14, 15, 17, 
                                  19, 22, 23, 24, 27, 28, 29, 34, 37, 38, 39, 42, 43, 44, 49, 51, 52, 53, 55, 58, 59, 60, 62,
                                  63, 69, 70, 71, 73, 75, 77, 85, 86, 88, 90, 91, 92, 94, 96, 98, 99, 100, 101, 103, 105, 
                                  106, 107, 109, 111, 112, 114, 119, 120, 121, 122, 123, 127, 129, 130, 131, 132, 134, 135, 
                                  137, 138, 139, 141, 143, 145, 146, 147, 148, 152, 163, 165, 167, 168, 170, 173, 174, 176, 
                                  178, 180, 181, 182, 183, 185, 186, 187, 188, 189, 190, 192, 196, 199, 201, 202, 208, 209, 
                                  210, 211, 212, 215, 217, 219, 221, 225, 227, 229, 230, 233, 234, 237, 239, 240, 241, 244, 
                                  245, 248, 249, 251, 253, 254, 260, 261, 263, 264, 265, 269, 271, 273, 274, 275, 279, 280, 
                                  284, 285, 287, 289, 290, 292, 294, 295, 300, 301, 305, 306, 308, 309, 310, 315, 319, 320, 
                                  322, 323, 325, 326, 327, 328, 329, 330, 331, 332, 333, 335, 339, 345, 346, 347, 348, 349, 
                                  350, 358, 361, 362, 367, 369, 372, 373, 374, 375, 376, 378, 381, 382, 383, 385, 387, 391, 
                                  392, 394, 396, 402, 406, 407, 408, 411, 412, 413, 416, 417, 418, 419, 422, 423, 424, 425, 
                                  427, 428, 430, 432, 433, 434, 435, 440, 442, 443, 445, 446, 447, 448, 449, 454, 456, 457, 
                                  462, 463, 464, 468, 469, 471, 472, 475, 478, 480, 483, 490, 492, 493, 495, 496, 497, 498, 
                                  500, 501, 502, 506, 508, 509, 510, 511, 512, 515, 520, 521, 523, 524, 526, 529, 531, 532, 
                                  537, 538, 539, 540, 542, 546, 547, 548, 549, 550, 553, 555, 558, 561, 562, 564, 565, 567, 
                                  569, 570, 571, 574, 575, 579, 582, 583, 585, 588, 589, 590, 592, 594, 599, 601, 607, 608, 
                                  611, 612, 613, 614, 615, 616, 617, 618, 619, 621, 622, 625, 626, 627, 629, 630, 632, 634, 
                                  635, 636, 637, 638, 640, 644, 645, 649, 654, 657, 658, 660, 662, 666, 672, 674, 676, 679, 
                                  680, 681, 682, 683, 685, 690, 694, 698, 704, 707, 708, 709, 711, 714, 718, 720, 723, 725, 
                                  728, 729, 730, 732, 735, 736, 742, 744, 747, 749, 750, 751, 752, 753, 754, 755, 756, 758, 
                                  759, 760, 763, 764, 769, 770, 772, 774, 777, 780, 782, 789, 792, 793, 794, 797, 798, 804, 
                                  805, 808, 813, 814, 815, 816, 821, 822, 824, 827, 830, 838, 839, 841, 845, 846, 847, 848, 
                                  850, 851, 854, 856, 858, 860, 862, 864, 868, 870, 871, 875, 877, 878, 879, 882, 884, 887,
                                  888, 890, 894, 895, 897, 899, 901, 902, 904, 905, 906, 907, 909, 910, 912, 914, 915, 920,
                                  923, 925, 926, 928, 931, 932, 934, 937, 938, 941, 943, 944, 946, 947, 949, 950, 952, 955,
                                  956, 959, 965, 969, 970, 973, 975, 976, 977, 982, 983, 984, 988, 989, 990, 993, 994, 995, 996, 998, 999],
                                9088))
# [-4,-1,1,2]